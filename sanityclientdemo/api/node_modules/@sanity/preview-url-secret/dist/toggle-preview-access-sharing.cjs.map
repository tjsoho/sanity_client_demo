{"version":3,"file":"toggle-preview-access-sharing.cjs","sources":["../src/togglePreviewAccessSharing.ts"],"sourcesContent":["import type {SanityClient} from '@sanity/client'\nimport {schemaIdSingleton as _id, schemaTypeSingleton as _type, apiVersion, tag} from './constants'\nimport {generateUrlSecret} from './generateSecret'\nimport type {SanityClientLike} from './types'\n\n/** @internal */\nexport async function enablePreviewAccessSharing(\n  _client: SanityClient,\n  source: string,\n  studioUrl: string,\n  userId?: string,\n): Promise<{secret: string}> {\n  const client = _client.withConfig({apiVersion})\n  const newSecret = generateUrlSecret()\n  const patch = client.patch(_id).set({secret: newSecret, studioUrl, userId})\n  await client\n    .transaction()\n    .createIfNotExists({_id, _type, source, studioUrl, userId})\n    .patch(patch)\n    .commit({tag})\n\n  return {secret: newSecret}\n}\n\n/** @internal */\nexport async function disablePreviewAccessSharing(\n  _client: SanityClient,\n  source: string,\n  studioUrl: string,\n  userId?: string,\n): Promise<void> {\n  const client = _client.withConfig({apiVersion})\n  const patch = client.patch(_id).set({secret: null, studioUrl, userId})\n  await client\n    .transaction()\n    .createIfNotExists({_id, _type, source, studioUrl, userId})\n    .patch(patch)\n    .commit({tag})\n}\n\nexport type {SanityClientLike}\n"],"names":["apiVersion","generateUrlSecret","_id","_type","tag"],"mappings":";;;;;;;AAMA,eAAsB,0BACpB,CAAA,OAAA,EACA,MACA,EAAA,SAAA,EACA,MAC2B,EAAA;AAC3B,EAAA,MAAM,MAAS,GAAA,OAAA,CAAQ,UAAW,CAAA,cAACA,sBAAW,CAAA,CAAA;AAC9C,EAAA,MAAM,YAAYC,gCAAkB,EAAA,CAAA;AACpC,EAAM,MAAA,KAAA,GAAQ,MAAO,CAAA,KAAA,CAAMC,2BAAG,CAAA,CAAE,GAAI,CAAA,EAAC,MAAQ,EAAA,SAAA,EAAW,SAAW,EAAA,MAAA,EAAO,CAAA,CAAA;AAC1E,EAAA,MAAM,OACH,WAAY,EAAA,CACZ,kBAAkB,OAACA,2BAAA,SAAKC,+BAAO,MAAQ,EAAA,SAAA,EAAW,MAAM,EAAC,EACzD,KAAM,CAAA,KAAK,EACX,MAAO,CAAA,OAACC,eAAI,CAAA,CAAA;AAEf,EAAO,OAAA,EAAC,QAAQ,SAAS,EAAA,CAAA;AAC3B,CAAA;AAGA,eAAsB,2BACpB,CAAA,OAAA,EACA,MACA,EAAA,SAAA,EACA,MACe,EAAA;AACf,EAAA,MAAM,MAAS,GAAA,OAAA,CAAQ,UAAW,CAAA,cAACJ,sBAAW,CAAA,CAAA;AAC9C,EAAM,MAAA,KAAA,GAAQ,MAAO,CAAA,KAAA,CAAME,2BAAG,CAAA,CAAE,GAAI,CAAA,EAAC,MAAQ,EAAA,IAAA,EAAM,SAAW,EAAA,MAAA,EAAO,CAAA,CAAA;AACrE,EAAA,MAAM,OACH,WAAY,EAAA,CACZ,kBAAkB,OAACA,2BAAA,SAAKC,+BAAO,MAAQ,EAAA,SAAA,EAAW,MAAM,EAAC,EACzD,KAAM,CAAA,KAAK,EACX,MAAO,CAAA,OAACC,eAAI,CAAA,CAAA;AACjB;;;;;"}