{"version":3,"file":"hooks.js","sources":["../../../visual-editing-helpers/dist/hooks.js"],"sourcesContent":["import { useMemo, useState, useCallback, useEffect, useSyncExternalStore } from \"react\";\nfunction useQueryParams(params) {\n  const stringifiedParams = useMemo(() => JSON.stringify(params || {}), [params]);\n  return useMemo(() => JSON.parse(stringifiedParams), [stringifiedParams]);\n}\nfunction useRevalidate(props) {\n  const { refreshInterval } = props, shouldPause = useShouldPause(), [state, setState] = useState(\"hit\"), startRefresh = useCallback(() => (setState(\"inflight\"), () => setState(\"hit\")), []);\n  return useEffect(() => {\n    if (!refreshInterval || state !== \"hit\")\n      return;\n    const timeout = setTimeout(() => setState(\"stale\"), refreshInterval);\n    return () => clearTimeout(timeout);\n  }, [refreshInterval, state]), useEffect(() => {\n    if (state !== \"hit\")\n      return;\n    const onFocus = () => setState(\"stale\");\n    return window.addEventListener(\"focus\", onFocus), () => window.removeEventListener(\"focus\", onFocus);\n  }, [refreshInterval, state]), useEffect(() => {\n    shouldPause && state === \"hit\" && setState(\"stale\"), !shouldPause && state === \"stale\" && setState(\"refresh\");\n  }, [shouldPause, state]), [state, startRefresh];\n}\nfunction useShouldPause() {\n  const [online, setOnline] = useState(!1);\n  useEffect(() => {\n    setOnline(navigator.onLine);\n    const online2 = () => setOnline(!0), offline = () => setOnline(!1);\n    return window.addEventListener(\"online\", online2), window.addEventListener(\"offline\", offline), () => {\n      window.removeEventListener(\"online\", online2), window.removeEventListener(\"offline\", offline);\n    };\n  }, []);\n  const visibilityState = useSyncExternalStore(\n    onVisibilityChange,\n    () => document.visibilityState,\n    () => \"hidden\"\n  );\n  return !online || visibilityState === \"hidden\";\n}\nfunction onVisibilityChange(onStoreChange) {\n  return document.addEventListener(\"visibilitychange\", onStoreChange), () => document.removeEventListener(\"visibilitychange\", onStoreChange);\n}\nexport {\n  useQueryParams,\n  useRevalidate\n};\n//# sourceMappingURL=hooks.js.map\n"],"names":[],"mappings":";AACA,SAAS,eAAe,QAAQ;AACxB,QAAA,oBAAoB,QAAQ,MAAM,KAAK,UAAU,UAAU,EAAE,GAAG,CAAC,MAAM,CAAC;AACvE,SAAA,QAAQ,MAAM,KAAK,MAAM,iBAAiB,GAAG,CAAC,iBAAiB,CAAC;AACzE;AACA,SAAS,cAAc,OAAO;AACtB,QAAA,EAAE,oBAAoB,OAAO,cAAc,eAAkB,GAAA,CAAC,OAAO,QAAQ,IAAI,SAAS,KAAK,GAAG,eAAe,YAAY,OAAO,SAAS,UAAU,GAAG,MAAM,SAAS,KAAK,IAAI,CAAA,CAAE;AAC1L,SAAO,UAAU,MAAM;AACjB,QAAA,CAAC,mBAAmB,UAAU;AAChC;AACF,UAAM,UAAU,WAAW,MAAM,SAAS,OAAO,GAAG,eAAe;AAC5D,WAAA,MAAM,aAAa,OAAO;AAAA,KAChC,CAAC,iBAAiB,KAAK,CAAC,GAAG,UAAU,MAAM;AAC5C,QAAI,UAAU;AACZ;AACI,UAAA,UAAU,MAAM,SAAS,OAAO;AAC/B,WAAA,OAAO,iBAAiB,SAAS,OAAO,GAAG,MAAM,OAAO,oBAAoB,SAAS,OAAO;AAAA,KAClG,CAAC,iBAAiB,KAAK,CAAC,GAAG,UAAU,MAAM;AAC7B,mBAAA,UAAU,SAAS,SAAS,OAAO,GAAG,CAAC,eAAe,UAAU,WAAW,SAAS,SAAS;AAAA,EAAA,GAC3G,CAAC,aAAa,KAAK,CAAC,GAAG,CAAC,OAAO,YAAY;AAChD;AACA,SAAS,iBAAiB;AACxB,QAAM,CAAC,QAAQ,SAAS,IAAI,SAAS,EAAE;AACvC,YAAU,MAAM;AACd,cAAU,UAAU,MAAM;AACpB,UAAA,UAAU,MAAM,UAAU,EAAE,GAAG,UAAU,MAAM,UAAU,EAAE;AAC1D,WAAA,OAAO,iBAAiB,UAAU,OAAO,GAAG,OAAO,iBAAiB,WAAW,OAAO,GAAG,MAAM;AACpG,aAAO,oBAAoB,UAAU,OAAO,GAAG,OAAO,oBAAoB,WAAW,OAAO;AAAA,IAAA;AAAA,EAEhG,GAAG,CAAE,CAAA;AACL,QAAM,kBAAkB;AAAA,IACtB;AAAA,IACA,MAAM,SAAS;AAAA,IACf,MAAM;AAAA,EAAA;AAED,SAAA,CAAC,UAAU,oBAAoB;AACxC;AACA,SAAS,mBAAmB,eAAe;AAClC,SAAA,SAAS,iBAAiB,oBAAoB,aAAa,GAAG,MAAM,SAAS,oBAAoB,oBAAoB,aAAa;AAC3I;"}